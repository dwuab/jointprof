<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Joint Profiling of Native C/C++ and R Code • jointprof</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Joint Profiling of Native C/C++ and R Code">
<meta property="og:description" content="Simultaneously collects profiling data at both the
    R and C/C++ levels (using Rprof and Googles libprofiler from
    gperftools) and collates the results to present a unified view of
    the collected data.  Supports writing these combined profiles to Rs
    usual Rprof.out format (for interoperability with existing tools) or
    interacting with the external pprof program for its rich
    visualization tools.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">jointprof</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/jointprof.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/internals.html">Collecting and merging dual call stacks</a>
    </li>
    <li>
      <a href="articles/proposal.html">Proposal: Joint profiling of native and R code</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-prof/jointprof/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="jointprof" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#jointprof" class="anchor"></a>jointprof</h1></div>

<p>The goal of jointprof is to assist profiling R packages that include native code (C++, C, Fortran, …). It collects profiling output simultaneously using <a href="https://www.rdocumentation.org/packages/utils/versions/3.4.3/topics/Rprof" class="external-link">Rprof</a> and <a href="https://github.com/gperftools/gperftools" class="external-link">gperftools</a> and provides a unified view of profiling data.</p>
<p>See the <a href="https://r-prof.github.io/jointprof/articles/guide.html" class="external-link">guide</a> for a more detailed overview, or take a look at the <a href="https://r-prof.github.io/jointprof/articles/internals.html" class="external-link">internals</a> document if you’re curious.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div id="ubuntu" class="section level3">
<h3 class="hasAnchor">
<a href="#ubuntu" class="anchor"></a>Ubuntu</h3>
<p>Other Linux distributions may work if you install the right system dependencies (<a href="https://github.com/r-prof/jointprof/issues" class="external-link">let me know</a> which!).</p>
<ol style="list-style-type: decimal">
<li>
<p>Install system dependencies:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">sudo</span> apt install \</span>
<span id="cb1-2"><a href="#cb1-2"></a>  libgoogle-perftools-dev \</span>
<span id="cb1-3"><a href="#cb1-3"></a>  libprotoc-dev libprotobuf-dev protobuf-compiler \</span>
<span id="cb1-4"><a href="#cb1-4"></a>  golang-go \</span>
<span id="cb1-5"><a href="#cb1-5"></a>  graphviz</span></code></pre></div>
</li>
<li>
<p>Install <code>pprof</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="ex">go</span> get github.com/google/pprof</span></code></pre></div>
</li>
<li>
<p>Install the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"r-prof/jointprof"</span><span class="op">)</span></code></pre></div>
</li>
</ol>
</div>
<div id="os-x" class="section level3">
<h3 class="hasAnchor">
<a href="#os-x" class="anchor"></a>OS X</h3>
<ol style="list-style-type: decimal">
<li>
<p>Install system dependencies:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="ex">brew</span> install graphviz</span></code></pre></div>
</li>
<li>
<p>Install <code>gperftools</code> (currently from a branch, <a href="https://github.com/gperftools/gperftools/pull/1004" class="external-link">pull request</a> pending):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">git</span> clone https://github.com/krlmlr/gperftools.git -b f-export-stack</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="bu">cd</span> gperftools</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="ex">./autogen.sh</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="ex">./configure</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">make</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">sudo</span> make install</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="bu">cd</span> ..</span></code></pre></div>
</li>
<li>
<p>Install <code>pprof</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="ex">go</span> get github.com/google/pprof</span></code></pre></div>
</li>
<li>
<p>Install the package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"r-prof/jointprof"</span><span class="op">)</span></code></pre></div>
</li>
</ol>
</div>
<div id="other-os" class="section level3">
<h3 class="hasAnchor">
<a href="#other-os" class="anchor"></a>Other OS</h3>
<p>Windows and Solaris are not supported.</p>
</div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-prof.github.io/jointprof/" class="external-link">jointprof</a></span><span class="op">)</span>

<span class="va">target_file</span> <span class="op">&lt;-</span> <span class="st">"Rprof.out"</span>

<span class="co"># Collect profile data</span>
<span class="fu"><a href="reference/start_profiler.html">start_profiler</a></span><span class="op">(</span><span class="va">target_file</span><span class="op">)</span>
<span class="co">## code to be profiled</span>
<span class="fu"><a href="reference/start_profiler.html">stop_profiler</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Analyze profile data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/summaryRprof.html" class="external-link">summaryRprof</a></span><span class="op">(</span><span class="va">target_file</span><span class="op">)</span>
<span class="fu">profvis</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/profvis/man/profvis.html" class="external-link">profvis</a></span><span class="op">(</span>prof_input <span class="op">=</span> <span class="va">target_file</span><span class="op">)</span>
<span class="fu">proftools</span><span class="fu">::</span><span class="fu">readProfileData</span><span class="op">(</span><span class="va">target_file</span><span class="op">)</span>
<span class="fu">prof.tree</span><span class="fu">::</span><span class="fu">prof.tree</span><span class="op">(</span><span class="va">target_file</span><span class="op">)</span>

<span class="co"># Convert to pprof format and analyze</span>
<span class="va">pprof_target_file</span> <span class="op">&lt;-</span> <span class="st">"Rprof.pb.gz"</span>
<span class="va">profile_data</span> <span class="op">&lt;-</span> <span class="fu">profile</span><span class="fu">::</span><span class="fu"><a href="https://r-prof.github.io/profile/reference/read_rprof.html" class="external-link">read_rprof</a></span><span class="op">(</span><span class="va">target_file</span><span class="op">)</span>
<span class="fu">profile</span><span class="fu">::</span><span class="fu"><a href="https://r-prof.github.io/profile/reference/read_rprof.html" class="external-link">write_rprof</a></span><span class="op">(</span><span class="va">profile_data</span>, <span class="va">pprof_target_file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system2.html" class="external-link">system2</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/find_pprof.html">find_pprof</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="st">"-http"</span>,
    <span class="st">"localhost:8080"</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/shQuote.html" class="external-link">shQuote</a></span><span class="op">(</span><span class="va">pprof_target_file</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="acknowledgment" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgment" class="anchor"></a>Acknowledgment</h2>
<p>This project is being realized with financial support from the</p>
<p><img src="https://www.r-consortium.org/wp-content/uploads/sites/13/2016/09/RConsortium_Horizontal_Pantone.png" width="400"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/r-prof/jointprof/">https://​github.com/​r-prof/​jointprof/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/r-prof/jointprof/issues">https://​github.com/​r-prof/​jointprof/​issues</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://krlmlr.info">Kirill Müller</a> <br><small class="roles"> Author, maintainer </small>  </li>
<li>
<a href="https://www.r-consortium.org">R Consortium</a> <br><small class="roles"> Funder </small>  </li>
<li><a href="authors.html">More on authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/r-prof/jointprof" class="external-link"><img src="https://travis-ci.org/r-prof/jointprof.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/github/r-prof/jointprof?branch=master" class="external-link"><img src="https://codecov.io/gh/r-prof/jointprof/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://cran.r-project.org/package=jointprof" class="external-link"><img src="http://www.r-pkg.org/badges/version/jointprof" alt="CRAN status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://krlmlr.info" class="external-link">Kirill Müller</a>, <a href="https://www.r-consortium.org" class="external-link">R Consortium</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
